\documentclass{article}\usepackage[]{graphicx}\usepackage[]{xcolor}
% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlsng}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hldef}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage[sc]{mathpazo}
\renewcommand{\sfdefault}{lmss}
\renewcommand{\ttdefault}{lmtt}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\geometry{verbose,tmargin=2.5cm,bmargin=2.5cm,lmargin=2.5cm,rmargin=2.5cm}
\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{2}
\usepackage[unicode=true,pdfusetitle,
 bookmarks=true,bookmarksnumbered=true,bookmarksopen=true,bookmarksopenlevel=2,
 breaklinks=false,pdfborder={0 0 1},backref=false,colorlinks=false]
 {hyperref}
\hypersetup{
 pdfstartview={XYZ null null 1}}

\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\renewcommand{\textfraction}{0.05}
\renewcommand{\topfraction}{0.8}
\renewcommand{\bottomfraction}{0.8}
\renewcommand{\floatpagefraction}{0.75}

\makeatother
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}








The results below are generated from an R script.

---
title: "Stats_coursework"## Error in -title: invalid argument to unary operator
author: "Oluchi_Otuadinma"## Error: object 'author' not found
date: "2024-11-22"## Warning: NAs introduced by coercion
## Error in date:"2024-11-22": NA/NaN argument
output: pdf_document## Error: object 'output' not found
---
install.packages('MASS')## --- Please select a CRAN mirror for use in this session ---
## package 'MASS' successfully unpacked and MD5 sums checked
## Warning: cannot remove prior installation of package 'MASS'
## Warning in file.copy(savedcopy, lib, recursive = TRUE): problem copying E:\RStudio\R-4.4.2\library\00LOCK\MASS\libs\x64\MASS.dll to E:\RStudio\R-4.4.2\library\MASS\libs\x64\MASS.dll: Permission denied
## Warning: restored 'MASS'
## 
## The downloaded binary packages are in
## 	C:\Users\user\AppData\Local\Temp\Rtmp8g6HQI\downloaded_packages
## Error in -install.packages("MASS"): invalid argument to unary operator
install.packages('ISLR2')## package 'ISLR2' successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
## 	C:\Users\user\AppData\Local\Temp\Rtmp8g6HQI\downloaded_packages
install.packages('caret')## package 'caret' successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
## 	C:\Users\user\AppData\Local\Temp\Rtmp8g6HQI\downloaded_packages
install.packages('dplyr')## package 'dplyr' successfully unpacked and MD5 sums checked
## Warning: cannot remove prior installation of package 'dplyr'
## Warning in file.copy(savedcopy, lib, recursive = TRUE): problem copying E:\RStudio\R-4.4.2\library\00LOCK\dplyr\libs\x64\dplyr.dll to E:\RStudio\R-4.4.2\library\dplyr\libs\x64\dplyr.dll: Permission denied
## Warning: restored 'dplyr'
## 
## The downloaded binary packages are in
## 	C:\Users\user\AppData\Local\Temp\Rtmp8g6HQI\downloaded_packages
install.packages('FNN')## package 'FNN' successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
## 	C:\Users\user\AppData\Local\Temp\Rtmp8g6HQI\downloaded_packages
library(MASS)library(ISLR2)## 
## Attaching package: 'ISLR2'
## The following object is masked from 'package:MASS':
## 
##     Boston
library(dplyr)## 
## Attaching package: 'dplyr'
## The following object is masked from 'package:MASS':
## 
##     select
## The following objects are masked from 'package:stats':
## 
##     filter, lag
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
library(caret)## Loading required package: ggplot2
## Loading required package: lattice
library(ggplot2)library(FNN)library(nnet)setwd("E:/RStudio/Projects") Boston <- read.csv("boston_subset.cvs") head(Boston)##      crim zn indus chas   nox    rm  age    dis rad tax ptratio lstat medv
## 1 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3  4.98 24.0
## 2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8  9.14 21.6
## 3 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8  4.03 34.7
## 4 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7  2.94 33.4
## 5 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7  5.33 36.2
## 6 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7  5.21 28.7
# produced the boston dataset to aid in understandingsummary(Boston)##       crim                zn             indus            chas              nox        
##  Min.   : 0.00632   Min.   :  0.00   Min.   : 0.46   Min.   :0.00000   Min.   :0.3850  
##  1st Qu.: 0.08205   1st Qu.:  0.00   1st Qu.: 5.19   1st Qu.:0.00000   1st Qu.:0.4490  
##  Median : 0.25651   Median :  0.00   Median : 9.69   Median :0.00000   Median :0.5380  
##  Mean   : 3.61352   Mean   : 11.36   Mean   :11.14   Mean   :0.06917   Mean   :0.5547  
##  3rd Qu.: 3.67708   3rd Qu.: 12.50   3rd Qu.:18.10   3rd Qu.:0.00000   3rd Qu.:0.6240  
##  Max.   :88.97620   Max.   :100.00   Max.   :27.74   Max.   :1.00000   Max.   :0.8710  
##        rm             age              dis              rad              tax       
##  Min.   :3.561   Min.   :  2.90   Min.   : 1.130   Min.   : 1.000   Min.   :187.0  
##  1st Qu.:5.886   1st Qu.: 45.02   1st Qu.: 2.100   1st Qu.: 4.000   1st Qu.:279.0  
##  Median :6.208   Median : 77.50   Median : 3.207   Median : 5.000   Median :330.0  
##  Mean   :6.285   Mean   : 68.57   Mean   : 3.795   Mean   : 9.549   Mean   :408.2  
##  3rd Qu.:6.623   3rd Qu.: 94.08   3rd Qu.: 5.188   3rd Qu.:24.000   3rd Qu.:666.0  
##  Max.   :8.780   Max.   :100.00   Max.   :12.127   Max.   :24.000   Max.   :711.0  
##     ptratio          lstat            medv      
##  Min.   :12.60   Min.   : 1.73   Min.   : 5.00  
##  1st Qu.:17.40   1st Qu.: 6.95   1st Qu.:17.02  
##  Median :19.05   Median :11.36   Median :21.20  
##  Mean   :18.46   Mean   :12.65   Mean   :22.53  
##  3rd Qu.:20.20   3rd Qu.:16.95   3rd Qu.:25.00  
##  Max.   :22.00   Max.   :37.97   Max.   :50.00
head(Boston)##      crim zn indus chas   nox    rm  age    dis rad tax ptratio lstat medv
## 1 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3  4.98 24.0
## 2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8  9.14 21.6
## 3 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8  4.03 34.7
## 4 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7  2.94 33.4
## 5 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7  5.33 36.2
## 6 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7  5.21 28.7
# (a)# For reproducabilityset.seed(35)#seq_len creates a sequence of integers from 1 to n and assigns it to the rows in the boston dataset using nrow. #The sample function then randomly selects out of those numbers from til it reaches 66% of the total.train_indices <- sample(seq_len(nrow(Boston)), size = 0.66 * nrow(Boston))train_data <- Boston[train_indices, ] test_data <- Boston[-train_indices, ] # (b)# Use the cor function to find correlation over 0.5 and remove it from the datahead(train_data)                                   ##        crim   zn indus chas   nox    rm  age    dis rad tax ptratio lstat medv
## 330 0.06724  0.0  3.24    0 0.460 6.333 17.2 5.2146   4 430    16.9  7.34 22.6
## 198 0.04666 80.0  1.52    0 0.404 7.107 36.6 7.3090   2 329    12.6  8.61 30.3
## 392 5.29305  0.0 18.10    0 0.700 6.051 82.5 2.1678  24 666    20.2 18.76 23.2
## 321 0.16760  0.0  7.38    0 0.493 6.426 52.3 4.5404   5 287    19.6  7.20 23.8
## 135 0.97617  0.0 21.89    0 0.624 5.757 98.4 2.3460   4 437    21.2 17.31 15.6
## 11  0.22489 12.5  7.87    0 0.524 6.377 94.3 6.3467   5 311    15.2 20.45 15.0
cor_matrix <- cor(train_data[, !(colnames(train_data) %in% 'crim')])                      cor_matrix##                 zn       indus        chas         nox         rm         age         dis
## zn       1.0000000 -0.51404783 -0.01441450 -0.50089779  0.2842906 -0.54695343  0.65579029
## indus   -0.5140478  1.00000000  0.04084893  0.76400975 -0.3668226  0.61690510 -0.68813654
## chas    -0.0144145  0.04084893  1.00000000  0.03568379  0.1482074  0.06244542 -0.08110491
## nox     -0.5008978  0.76400975  0.03568379  1.00000000 -0.2706141  0.72408827 -0.76815830
## rm       0.2842906 -0.36682260  0.14820739 -0.27061414  1.0000000 -0.20223320  0.15750456
## age     -0.5469534  0.61690510  0.06244542  0.72408827 -0.2022332  1.00000000 -0.73539390
## dis      0.6557903 -0.68813654 -0.08110491 -0.76815830  0.1575046 -0.73539390  1.00000000
## rad     -0.2981497  0.61220155  0.01699943  0.63310990 -0.2249925  0.43092856 -0.49476479
## tax     -0.2941421  0.72166635 -0.02275640  0.68699846 -0.3113567  0.47817228 -0.52557932
## ptratio -0.3525111  0.35313285 -0.08936011  0.18738778 -0.3741991  0.26248406 -0.21754300
## lstat   -0.3903303  0.59130913 -0.11233623  0.56958221 -0.6513453  0.56762663 -0.46070076
## medv     0.3195342 -0.43236393  0.28436363 -0.39437852  0.7259391 -0.33841720  0.19638298
##                 rad        tax     ptratio      lstat       medv
## zn      -0.29814966 -0.2941421 -0.35251107 -0.3903303  0.3195342
## indus    0.61220155  0.7216663  0.35313285  0.5913091 -0.4323639
## chas     0.01699943 -0.0227564 -0.08936011 -0.1123362  0.2843636
## nox      0.63310990  0.6869985  0.18738778  0.5695822 -0.3943785
## rm      -0.22499252 -0.3113567 -0.37419908 -0.6513453  0.7259391
## age      0.43092856  0.4781723  0.26248406  0.5676266 -0.3384172
## dis     -0.49476479 -0.5255793 -0.21754300 -0.4607008  0.1963830
## rad      1.00000000  0.9192952  0.43787906  0.4960720 -0.3568792
## tax      0.91929521  1.0000000  0.44059005  0.5484208 -0.4426691
## ptratio  0.43787906  0.4405901  1.00000000  0.4005892 -0.5103019
## lstat    0.49607197  0.5484208  0.40058920  1.0000000 -0.7427944
## medv    -0.35687924 -0.4426691 -0.51030186 -0.7427944  1.0000000
columns_to_remove <- findCorrelation(
  cor_matrix,
  cutoff = 0.5,
  verbose = FALSE,
  names = TRUE,
)columns_to_remove## [1] "indus" "nox"   "lstat" "tax"   "dis"   "age"   "medv"
reduced_data <- train_data %>% select(-nox, -indus, -lstat, -tax, -dis, -age, -medv)low_corr <- lm(crim ~ ., reduced_data)summary(low_corr)## 
## Call:
## lm(formula = crim ~ ., data = reduced_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.950  -1.598  -0.245   0.862  54.665 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 13.324182   4.981641   2.675 0.007857 ** 
## zn           0.007573   0.014371   0.527 0.598586    
## chas        -1.219549   1.222306  -0.998 0.319141    
## rm          -1.931399   0.506326  -3.815 0.000163 ***
## rad          0.609310   0.040277  15.128  < 2e-16 ***
## ptratio     -0.183926   0.170818  -1.077 0.282391    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 5.564 on 327 degrees of freedom
## Multiple R-squared:  0.4922,	Adjusted R-squared:  0.4845 
## F-statistic:  63.4 on 5 and 327 DF,  p-value: < 2.2e-16
plot(reduced_data)figure/stats-coursework-Rnwauto-report-1.pdf# (c)# I can reject the null hypothesis, H0 : βj = 0, for rm and rad as their p-values are less than 0.05 and are therefore significant.# (d)lm.fit <- lm(crim ~ zn + chas + rm + rad + ptratio, data = reduced_data)summary(lm.fit)## 
## Call:
## lm(formula = crim ~ zn + chas + rm + rad + ptratio, data = reduced_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.950  -1.598  -0.245   0.862  54.665 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 13.324182   4.981641   2.675 0.007857 ** 
## zn           0.007573   0.014371   0.527 0.598586    
## chas        -1.219549   1.222306  -0.998 0.319141    
## rm          -1.931399   0.506326  -3.815 0.000163 ***
## rad          0.609310   0.040277  15.128  < 2e-16 ***
## ptratio     -0.183926   0.170818  -1.077 0.282391    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 5.564 on 327 degrees of freedom
## Multiple R-squared:  0.4922,	Adjusted R-squared:  0.4845 
## F-statistic:  63.4 on 5 and 327 DF,  p-value: < 2.2e-16
lm.fit <- lm(crim ~ chas + rm + rad + ptratio, data = reduced_data)summary(lm.fit)## 
## Call:
## lm(formula = crim ~ chas + rm + rad + ptratio, data = reduced_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.897  -1.591  -0.273   0.818  54.685 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 13.49371    4.96576   2.717 0.006930 ** 
## chas        -1.25952    1.21861  -1.034 0.302097    
## rm          -1.88535    0.49818  -3.784 0.000183 ***
## rad          0.60599    0.03974  15.250  < 2e-16 ***
## ptratio     -0.20231    0.16703  -1.211 0.226688    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 5.558 on 328 degrees of freedom
## Multiple R-squared:  0.4918,	Adjusted R-squared:  0.4856 
## F-statistic: 79.35 on 4 and 328 DF,  p-value: < 2.2e-16
lm.fit <- lm(crim ~ rm + rad + ptratio, data = reduced_data)summary(lm.fit)## 
## Call:
## lm(formula = crim ~ rm + rad + ptratio, data = reduced_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.871  -1.564  -0.242   0.924  54.758 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 13.65286    4.96389   2.750  0.00628 ** 
## rm          -1.95201    0.49404  -3.951 9.52e-05 ***
## rad          0.60301    0.03964  15.213  < 2e-16 ***
## ptratio     -0.19152    0.16672  -1.149  0.25149    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 5.559 on 329 degrees of freedom
## Multiple R-squared:  0.4901,	Adjusted R-squared:  0.4855 
## F-statistic: 105.4 on 3 and 329 DF,  p-value: < 2.2e-16
final_model <- lm(crim ~ rm + rad, data = reduced_data)summary(lm.fit)## 
## Call:
## lm(formula = crim ~ rm + rad + ptratio, data = reduced_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.871  -1.564  -0.242   0.924  54.758 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 13.65286    4.96389   2.750  0.00628 ** 
## rm          -1.95201    0.49404  -3.951 9.52e-05 ***
## rad          0.60301    0.03964  15.213  < 2e-16 ***
## ptratio     -0.19152    0.16672  -1.149  0.25149    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 5.559 on 329 degrees of freedom
## Multiple R-squared:  0.4901,	Adjusted R-squared:  0.4855 
## F-statistic: 105.4 on 3 and 329 DF,  p-value: < 2.2e-16
final_model_df <- reduced_data %>% select(-zn, -chas, -ptratio)plot(final_model_df)figure/stats-coursework-Rnwauto-report-2.pdf# (e) # All remaining predictors are statistically significant (rm and rad) through use of backwards elimination# The t-value of rm is -3.78 indicating a negative relationship with crim. this means that an increase in rm should decrease crim.That being said it has a high standard error so it has a large level of uncertainty and is therefore less reliable# There is a strong positive relationship between rad and crim with a t-value of 16.04 showing that an increase in rad will have a large positive effect on crim. it has a low standard error # (f)# crim =  β0 + β1 ⋅ rm + β2 ⋅ rad  + ϵ# (g)# model b has an r^2 value of 0.4922 and adjusted r^2 of 0.4845. this indicates that 48% of the variability in the target (crim) variable can be explained by the predictor variables in this case variability in the target (dependent) variable can be explained by the predictor (independent) variables zn, chas, rm, rad, and ptratio.# model d has a similar r^2 and adjusted r^2 of 0.4881 and 0.485, respectively. The models have relatively good evidence of correlation# (h)#crim = 9.15436 + -1.77340 (rm), crim = 9.15436 + 0.58519 (rad)confint(final_model, 'rm', level = 0.95)##        2.5 %     97.5 %
## rm -2.696324 -0.8504759
#the confidence interval for rm is [-2.696, -0.8505]confint(final_model, 'rad', level = 0.95)##         2.5 %    97.5 %
## rad 0.5133998 0.6569703
#the confidence interval for rad is [0.5134, 0.6570]# (i)?ggplot()ggplot() + geom_point(aes(final_model_df$rm,final_model_df$crim)) + 
  geom_smooth(aes(final_model_df$rm,final_model_df$crim), method="lm", se=F)## `geom_smooth()` using formula = 'y ~ x'
figure/stats-coursework-Rnwauto-report-3.pdfggplot() + geom_point(aes(final_model_df$rad,final_model_df$crim)) + 
  geom_smooth(aes(final_model_df$rad,final_model_df$crim), method="lm", se=F)## `geom_smooth()` using formula = 'y ~ x'
figure/stats-coursework-Rnwauto-report-4.pdf# there is evidence of both outliers and high leverage observations for both predictors.There is very little data that follows the trend.# (j)predictors <- as.matrix(final_model_df[, c("rm", "rad")])models <- list()for (k in 1:3) {
models[[paste("k=", k)]] <- knn.reg(train = predictors, y = final_model_df$crim, k = k)
}models## $`k= 1`
## PRESS =  19300.01 
## R2-Predict =  0.03198857 
## 
## $`k= 2`
## PRESS =  16903.32 
## R2-Predict =  0.1521968 
## 
## $`k= 3`
## PRESS =  15605.22 
## R2-Predict =  0.2173043
# (k)?predict()test_predictions_b <- predict(low_corr, newdata = test_data)summary(test_predictions_b)##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -4.3523  0.2135  1.2698  3.9916 11.1336 17.3546
test_predictions_d <- predict(final_model, newdata = test_data)head(test_predictions_d)##          5          7          9         17         19         35 
## -1.7645753  1.4186041  2.0942695  0.9699708  1.8194295  0.6844534
test_predictors <- as.matrix(test_data[, c("rm", "rad")]) test_predictions_j <- list()for (k in 1:3) {
  test_predictions_j[[paste("k=", k)]] <- knn.reg(train = predictors, test = ,  y = final_model_df$crim, k = k)$pred
}head(test_predictions_j[["k=3"]])## NULL
test_predictors##        rm rad
## 5   7.147   3
## 7   6.012   5
## 9   5.631   5
## 17  5.935   4
## 19  5.456   4
## 35  6.096   4
## 36  5.933   5
## 38  5.850   5
## 41  7.024   3
## 52  6.115   4
## 57  6.383   2
## 58  6.816   5
## 59  6.145   8
## 61  5.741   8
## 65  7.104   3
## 76  6.286   5
## 77  6.279   5
## 78  6.140   5
## 80  5.874   5
## 82  6.619   4
## 93  6.442   4
## 97  6.163   2
## 98  8.069   2
## 99  7.820   2
## 101 6.727   5
## 102 6.781   5
## 107 5.836   5
## 111 6.195   5
## 112 6.715   6
## 116 5.928   6
## 117 6.176   6
## 121 5.870   2
## 122 6.004   2
## 125 5.879   2
## 128 5.693   4
## 129 6.431   4
## 132 6.326   4
## 137 5.942   4
## 142 5.019   4
## 143 5.403   5
## 144 5.468   5
## 145 4.903   5
## 149 5.186   5
## 150 5.597   5
## 153 5.012   5
## 156 6.152   5
## 159 6.066   5
## 161 6.250   5
## 167 7.929   5
## 169 6.319   5
## 173 5.572   5
## 177 6.020   5
## 178 6.315   5
## 186 6.153   3
## 187 7.831   3
## 189 6.556   5
## 190 7.185   5
## 191 6.951   5
## 192 6.739   5
## 194 6.800   1
## 196 7.875   4
## 197 7.287   2
## 200 6.975   3
## 204 7.853   4
## 206 5.891   4
## 212 5.404   4
## 216 6.182   4
## 217 5.888   5
## 219 5.951   5
## 222 6.164   8
## 223 6.879   8
## 231 5.981   8
## 233 8.337   8
## 234 8.247   8
## 236 6.086   8
## 242 6.095   6
## 243 6.358   6
## 245 5.593   7
## 250 6.718   7
## 251 6.487   7
## 252 6.438   7
## 254 8.259   7
## 259 7.333   5
## 263 8.398   5
## 265 7.206   5
## 268 8.297   5
## 272 6.240   3
## 277 7.267   4
## 279 6.482   4
## 280 6.812   5
## 285 7.088   1
## 286 6.453   1
## 289 6.315   6
## 300 7.041   5
## 301 6.871   5
## 302 6.590   7
## 304 6.982   7
## 305 7.236   7
## 308 6.849   7
## 311 4.973   4
## 312 6.122   4
## 314 6.266   4
## 315 6.567   4
## 317 5.914   4
## 318 5.782   4
## 319 6.382   4
## 322 6.376   5
## 324 5.708   5
## 327 6.312   5
## 328 6.083   5
## 333 6.031   1
## 334 6.316   5
## 338 5.895   5
## 341 5.968   5
## 342 7.241   1
## 343 6.540   1
## 346 6.014   3
## 356 5.936   4
## 358 6.395  24
## 363 5.362  24
## 365 8.780  24
## 366 3.561  24
## 369 4.970  24
## 374 4.906  24
## 378 6.794  24
## 379 6.380  24
## 381 6.968  24
## 383 5.536  24
## 394 6.193  24
## 398 5.747  24
## 399 5.453  24
## 400 5.852  24
## 401 5.987  24
## 402 6.343  24
## 403 6.404  24
## 407 4.138  24
## 408 5.608  24
## 410 6.852  24
## 413 4.628  24
## 417 6.782  24
## 419 5.957  24
## 423 5.648  24
## 424 6.103  24
## 425 5.565  24
## 427 5.837  24
## 430 6.380  24
## 432 6.833  24
## 438 6.152  24
## 440 5.627  24
## 443 6.219  24
## 444 6.485  24
## 447 6.341  24
## 448 6.251  24
## 449 6.185  24
## 452 6.655  24
## 458 5.936  24
## 460 6.081  24
## 461 6.701  24
## 463 6.317  24
## 464 6.513  24
## 471 6.167  24
## 472 6.229  24
## 476 6.162  24
## 477 6.484  24
## 480 6.229  24
## 482 6.750  24
## 486 6.312  24
## 488 5.905  24
## 490 5.414   4
## 492 5.983   4
## 493 5.983   4
## 495 5.926   6
## 506 6.030   1
# Task 2 Boston_2 <- Boston# (a)low_percentile <- quantile(Boston_2$crim, 0.25)high_percentile <- quantile(Boston_2$crim, 0.75)Boston_2$class <- ifelse(Boston_2$crim > high_percentile, "high", 
                   ifelse(Boston_2$crim < low_percentile, "low", "medium"))Boston_2$crim <- NULLhead(Boston_2)##   zn indus chas   nox    rm  age    dis rad tax ptratio lstat medv class
## 1 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3  4.98 24.0   low
## 2  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8  9.14 21.6   low
## 3  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8  4.03 34.7   low
## 4  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7  2.94 33.4   low
## 5  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7  5.33 36.2   low
## 6  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7  5.21 28.7   low
# (b)train_indices <- createDataPartition(
  Boston_2$class,
  times = 1,
  p = 0.66,
  list = FALSE,
)boston_train <- Boston_2[train_indices , ]boston_test <- Boston_2[-train_indices , ]nrow(boston_train)## [1] 335
# (c)cor_matrix_2 <- cor(boston_train[, !(colnames(boston_train) %in% 'class')])                      cor_matrix_2##                  zn       indus         chas        nox          rm        age        dis
## zn       1.00000000 -0.51884958 -0.095423244 -0.4974042  0.33557167 -0.5242207  0.6524914
## indus   -0.51884958  1.00000000  0.081257162  0.7754768 -0.41422436  0.6344617 -0.7043320
## chas    -0.09542324  0.08125716  1.000000000  0.1065538  0.05227922  0.1416771 -0.1162846
## nox     -0.49740421  0.77547675  0.106553756  1.0000000 -0.32170558  0.7259122 -0.7608102
## rm       0.33557167 -0.41422436  0.052279219 -0.3217056  1.00000000 -0.2523707  0.2365291
## age     -0.52422070  0.63446172  0.141677133  0.7259122 -0.25237065  1.0000000 -0.7325914
## dis      0.65249142 -0.70433203 -0.116284573 -0.7608102  0.23652909 -0.7325914  1.0000000
## rad     -0.30381393  0.63056658 -0.004152437  0.6031437 -0.26154131  0.4719339 -0.4934852
## tax     -0.30063596  0.74475509 -0.036658140  0.6628555 -0.33406824  0.5112600 -0.5363208
## ptratio -0.40137852  0.38248739 -0.099483548  0.1664074 -0.40728870  0.2564928 -0.2181963
## lstat   -0.41574095  0.61862006  0.009758897  0.6127302 -0.63522533  0.6003512 -0.5142507
## medv     0.36957527 -0.49298757  0.148277600 -0.4271165  0.72872947 -0.3832118  0.2610143
##                  rad         tax     ptratio        lstat       medv
## zn      -0.303813927 -0.30063596 -0.40137852 -0.415740951  0.3695753
## indus    0.630566576  0.74475509  0.38248739  0.618620056 -0.4929876
## chas    -0.004152437 -0.03665814 -0.09948355  0.009758897  0.1482776
## nox      0.603143688  0.66285546  0.16640742  0.612730187 -0.4271165
## rm      -0.261541305 -0.33406824 -0.40728870 -0.635225331  0.7287295
## age      0.471933864  0.51126003  0.25649279  0.600351207 -0.3832118
## dis     -0.493485166 -0.53632082 -0.21819632 -0.514250716  0.2610143
## rad      1.000000000  0.91158692  0.47982931  0.498565741 -0.3928480
## tax      0.911586922  1.00000000  0.45349251  0.556529968 -0.4771728
## ptratio  0.479829315  0.45349251  1.00000000  0.383400065 -0.5258527
## lstat    0.498565741  0.55652997  0.38340006  1.000000000 -0.7394078
## medv    -0.392847996 -0.47717282 -0.52585267 -0.739407773  1.0000000
subset_columns <- findCorrelation(
  cor_matrix,
  cutoff = 0.6,
  verbose = FALSE,
  names = TRUE,
)subset_columns## [1] "indus" "nox"   "lstat" "tax"   "dis"   "medv"
less_data <- boston_train %>% select(-nox, -indus, -lstat, -tax, -dis)model_multinom <- multinom(class ~ ., less_data,)## # weights:  27 (16 variable)
## initial  value 368.035117 
## iter  10 value 199.689263
## iter  20 value 109.922019
## iter  30 value 107.641481
## iter  40 value 106.918272
## iter  50 value 106.605881
## iter  60 value 106.601015
## final  value 106.584687 
## converged
# View the model summarysummary(model_multinom)## Call:
## multinom(formula = class ~ ., data = less_data)
## 
## Coefficients:
##        (Intercept)       zn       chas       rm        age       rad  ptratio       medv
## low      -1.012018 2.719272 -0.6913806 1.538837 -0.2387076 -1.777274 1.542953 0.08156918
## medium   -1.164570 2.676355  1.4897407 1.121799 -0.2194390 -1.075634 1.539208 0.07973445
## 
## Std. Errors:
##        (Intercept)          zn     chas       rm        age       rad   ptratio      medv
## low       1.829453 0.005927139 3.538247 2.107500 0.09978117 0.4108786 0.8588296 0.1463711
## medium    1.813557 0.005927139 3.350123 1.995788 0.09951474 0.3852020 0.8603120 0.1347352
## 
## Residual Deviance: 213.1694 
## AIC: 245.1694
library(knitr)knitr::stitch('stats_coursework.R')## 
## 
## processing file: stats_coursework.Rnw
## Error in parse_block(g[-1], g[1], params.src, markdown_mode): Duplicate chunk label 'setup', which has been used for the chunk:
## options(width=90)
## knitr::opts_chunk$set(out.width = '.6\\linewidth')
## .knitr.title = if (exists('.knitr.title')) paste('\\title{', .knitr.title, '}', sep = '') else ''
## .knitr.author = if (nzchar(.knitr.title) && exists('.knitr.author')) {
##   paste('\\author{', .knitr.author, '%\n',
##         '\\thanks{This report is automatically generated with the R package \\textbf{knitr}
##         (version ', packageVersion('knitr'), ').}}', sep = '')
## } else ''


The R session information (including the OS info, R version and all
packages used):

sessionInfo()## R version 4.4.2 (2024-10-31 ucrt)
## Platform: x86_64-w64-mingw32/x64
## Running under: Windows 10 x64 (build 19045)
## 
## Matrix products: default
## 
## 
## locale:
## [1] LC_COLLATE=English_United Kingdom.utf8  LC_CTYPE=English_United Kingdom.utf8   
## [3] LC_MONETARY=English_United Kingdom.utf8 LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.utf8    
## 
## time zone: Europe/London
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] knitr_1.49     nnet_7.3-19    FNN_1.1.4.1    caret_6.0-94   lattice_0.22-6
## [6] ggplot2_3.5.1  dplyr_1.1.4    ISLR2_1.3-2    MASS_7.3-61   
## 
## loaded via a namespace (and not attached):
##  [1] utf8_1.2.4           future_1.34.0        generics_0.1.3       class_7.3-22        
##  [5] stringi_1.8.4        pROC_1.18.5          listenv_0.9.1        digest_0.6.37       
##  [9] magrittr_2.0.3       timechange_0.3.0     evaluate_1.0.1       grid_4.4.2          
## [13] iterators_1.0.14     foreach_1.5.2        plyr_1.8.9           jsonlite_1.8.9      
## [17] Matrix_1.7-1         ModelMetrics_1.2.2.2 survival_3.7-0       mgcv_1.9-1          
## [21] purrr_1.0.2          fansi_1.0.6          scales_1.3.0         codetools_0.2-20    
## [25] lava_1.8.0           cli_3.6.3            rlang_1.1.4          hardhat_1.4.0       
## [29] parallelly_1.39.0    future.apply_1.11.3  munsell_0.5.1        splines_4.4.2       
## [33] withr_3.0.2          prodlim_2024.06.25   parallel_4.4.2       tools_4.4.2         
## [37] reshape2_1.4.4       colorspace_2.1-1     recipes_1.1.0        globals_0.16.3      
## [41] vctrs_0.6.5          R6_2.5.1             rpart_4.1.23         stats4_4.4.2        
## [45] lubridate_1.9.3      lifecycle_1.0.4      stringr_1.5.1        pkgconfig_2.0.3     
## [49] pillar_1.9.0         gtable_0.3.6         glue_1.8.0           data.table_1.16.2   
## [53] Rcpp_1.0.13-1        xfun_0.49            tibble_3.2.1         tidyselect_1.2.1    
## [57] highr_0.11           farver_2.1.2         nlme_3.1-166         labeling_0.4.3      
## [61] ipred_0.9-15         timeDate_4041.110    gower_1.0.1          compiler_4.4.2
Sys.time()## [1] "2024-11-22 11:48:50 GMT"



\end{document}
